var e=Object.defineProperty,l=Object.defineProperties,a=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,o=(l,a,t)=>a in l?e(l,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[a]=t,r=(e,l)=>{for(var a in l||(l={}))n.call(l,a)&&o(e,a,l[a]);if(t)for(var a of t(l))s.call(l,a)&&o(e,a,l[a]);return e},i=(e,t)=>l(e,a(t));import{f as u,r as d,p as c,a as p,o as m,c as v,b as y,t as g,u as h,w as b,d as f,e as w,g as P,F as k,h as S,i as C,j as U,v as D,k as I,l as j,m as A,n as N,q as L,s as V}from"./vendor.3e436ab0.js";u.initializeApp({apiKey:"AIzaSyDTmhsad6GJSgv1Av-ViRqIaHwzRM4fg3k",authDomain:"muso-ninjas-9ff84.firebaseapp.com",projectId:"muso-ninjas-9ff84",storageBucket:"muso-ninjas-9ff84.appspot.com",messagingSenderId:"1021090377552",appId:"1:1021090377552:web:1e29ed94f66b2d73f10655"});const E=u.firestore(),_=u.auth(),O=u.storage(),x=u.firestore.FieldValue.serverTimestamp,q=d(null),F=d(!1),H=async()=>{q.value=null,F.value=!0;try{await _.signOut(),F.value=!1}catch(e){console.log(e.message),q.value=e.message,F.value=!1}},M=d(_.currentUser);_.onAuthStateChanged((e=>{console.log("User state change. Current user is:",e),M.value=e}));const z=()=>({user:M});const R={setup(){const{logout:e}={error:q,logout:H,isPending:F},l=h(),{user:a}=z();return{handleClick:async()=>{await e(),console.log("user logged out"),l.push({name:"Login"})},user:a}}},B=b("data-v-61082b71");c("data-v-61082b71");const T={class:"navbar"},W=y("img",{src:"/assets/ninja.4041b599.png",alt:"ninja image"},null,-1),$=f("Muso Ninjas"),G={class:"links"},J={key:0},K=f("Create Playlist"),Q=f("My Playlists"),X={key:1},Y=f("Signup"),Z=f("Login");p();const ee=B(((e,l,a,t,n,s)=>{const o=w("router-link");return m(),v("div",T,[y("nav",null,[W,y("h1",null,[y(o,{to:{name:"Home"}},{default:B((()=>[$])),_:1})]),y("div",G,[t.user?(m(),v("div",J,[y(o,{to:{name:"CreatePlaylist"}},{default:B((()=>[K])),_:1}),y(o,{to:{name:"UserPlaylists"}},{default:B((()=>[Q])),_:1}),y("span",null,"Hi there, "+g(t.user.displayName),1),y("button",{onClick:l[1]||(l[1]=(...e)=>t.handleClick&&t.handleClick(...e))},"Logout")])):(m(),v("div",X,[y(o,{class:"btn",to:{name:"Signup"}},{default:B((()=>[Y])),_:1}),y(o,{class:"btn",to:{name:"Login"}},{default:B((()=>[Z])),_:1})]))])])])}));R.render=ee,R.__scopeId="data-v-61082b71";const le={components:{Navbar:R}},ae={class:"content"};le.render=function(e,l,a,t,n,s){const o=w("Navbar"),r=w("router-view");return m(),v("div",ae,[y(o),y(r)])};const te={props:["playlists"]},ne=b("data-v-c3375a8c");c("data-v-c3375a8c");const se={class:"single"},oe={class:"thumbnail"},re={class:"info"},ie={class:"song-number"};p();const ue=ne(((e,l,a,t,n,s)=>{const o=w("router-link");return m(!0),v(k,null,P(a.playlists,(e=>(m(),v("div",{key:e.id},[y(o,{to:{name:"PlaylistDetails",params:{id:e.id}}},{default:ne((()=>[y("div",se,[y("div",oe,[y("img",{src:e.coverUrl},null,8,["src"])]),y("div",re,[y("h3",null,g(e.title),1),y("p",null,"created by "+g(e.userName),1)]),y("div",ie,[y("p",null,g(e.songs.length)+" songs",1)])])])),_:2},1032,["to"])])))),128)}));te.render=ue,te.__scopeId="data-v-c3375a8c";const de=(e,l)=>{const a=d(null),t=d(null);let n=E.collection(e).orderBy("createdAt");l&&(n=n.where(...l));const s=n.onSnapshot((e=>{let l=[];e.docs.forEach((e=>{e.data().createdAt&&l.push(i(r({},e.data()),{id:e.id}))})),a.value=l,t.value=null}),(e=>{console.log(e.message),a.value=null,t.value="could not fetch the data"}));return S((e=>{e((()=>s()))})),{error:t,documents:a}},ce={name:"Home",components:{ListView:te},setup(){const{error:e,documents:l}=de("playlists");return{error:e,documents:l}}},pe={class:"home"},me={key:0,class:"error"},ve={key:1};ce.render=function(e,l,a,t,n,s){const o=w("ListView");return m(),v("div",pe,[t.error?(m(),v("div",me,"Could not fetch the data")):C("",!0),t.documents?(m(),v("div",ve,[y(o,{playlists:t.documents},null,8,["playlists"])])):C("",!0)])};const ye=d(null),ge=d(!1),he=async(e,l)=>{ye.value=null,ge.value=!0;try{const a=await _.signInWithEmailAndPassword(e,l);return ye.value=null,ge.value=!1,a}catch(a){console.log(a.message),ye.value="Incorrect login credentials",ge.value=!1}};const be={setup(){const{error:e,login:l,isPending:a}={error:ye,login:he,isPending:ge},t=h(),n=d(""),s=d("");return{email:n,password:s,handleSubmit:async()=>{await l(n.value,s.value),e.value||t.push({name:"UserPlaylists"})},error:e,isPending:a}}},fe=y("h3",null,"Login",-1),we={key:0,class:"error"},Pe={key:1},ke={key:2,disabled:""};be.render=function(e,l,a,t,n,s){return m(),v("form",{onSubmit:l[3]||(l[3]=I(((...e)=>t.handleSubmit&&t.handleSubmit(...e)),["prevent"]))},[fe,U(y("input",{type:"email",placeholder:"Email","onUpdate:modelValue":l[1]||(l[1]=e=>t.email=e)},null,512),[[D,t.email]]),U(y("input",{type:"text",placeholder:"Password","onUpdate:modelValue":l[2]||(l[2]=e=>t.password=e)},null,512),[[D,t.password]]),t.error?(m(),v("div",we,g(t.error),1)):C("",!0),t.isPending?C("",!0):(m(),v("button",Pe,"Log in")),t.isPending?(m(),v("button",ke,"Loading")):C("",!0)],32)};const Se=d(null),Ce=d(!1),Ue=async(e,l,a)=>{Se.value=null,Ce.value=!0;try{const t=await _.createUserWithEmailAndPassword(e,l);if(!t)throw new Error("Could not complete signup");return await t.user.updateProfile({displayName:a}),Se.value=null,Ce.value=!1,t}catch(t){console.log(t.message),Se.value=t.message,Ce.value=!1}};const De={setup(){const{error:e,signup:l,isPending:a}={error:Se,signup:Ue,isPending:Ce},t=h(),n=d(""),s=d(""),o=d("");return{email:n,password:s,displayName:o,handleSubmit:async()=>{await l(n.value,s.value,o.value),e.value||t.push({name:"UserPlaylists"})},error:e,isPending:a}}},Ie=y("h3",null,"Sign up",-1),je={key:0,class:"error"},Ae={key:1},Ne={key:2,disabled:""};De.render=function(e,l,a,t,n,s){return m(),v("form",{onSubmit:l[4]||(l[4]=I(((...e)=>t.handleSubmit&&t.handleSubmit(...e)),["prevent"]))},[Ie,U(y("input",{type:"text",placeholder:"Display name","onUpdate:modelValue":l[1]||(l[1]=e=>t.displayName=e)},null,512),[[D,t.displayName]]),U(y("input",{type:"email",placeholder:"Email","onUpdate:modelValue":l[2]||(l[2]=e=>t.email=e)},null,512),[[D,t.email]]),U(y("input",{type:"text",placeholder:"Password","onUpdate:modelValue":l[3]||(l[3]=e=>t.password=e)},null,512),[[D,t.password]]),t.error?(m(),v("div",je,g(t.error),1)):C("",!0),t.isPending?C("",!0):(m(),v("button",Ae,"Sign up")),t.isPending?(m(),v("button",Ne,"Loading")):C("",!0)],32)};const{user:Le}=z(),Ve=()=>{const e=d(null),l=d(null),a=d(null);return{uploadImage:async t=>{a.value=`covers/${Le.value.uid}/${t.name}`;const n=O.ref(a.value);try{const e=await n.put(t);l.value=await e.ref.getDownloadURL()}catch(s){console.log(s.message),e.value=s}},deleteImage:async l=>{const a=O.ref(l);try{await a.delete()}catch(t){console.log(t.message),e.value=t}},url:l,filePath:a,error:e}};const Ee={setup(){const{filePath:e,url:l,uploadImage:a}=Ve(),{error:t,addDoc:n}=(e=>{const l=d(null),a=d(!1);return{error:l,addDoc:async t=>{l.value=null,a.value=!0;try{const l=await E.collection(e).add(t);return a.value=!1,l}catch(n){console.log(n.message),l.value="could not send the message",a.value=!1}},isPending:a}})("playlists"),{user:s}=z(),o=h(),r=d(""),i=d(""),u=d(null),c=d(null),p=d(!1),m=["image/png","image/jpeg"];return{title:r,description:i,handleSubmit:async()=>{if(u.value){p.value=!0,await a(u.value);const d=await n({title:r.value,description:i.value,userId:s.value.uid,userName:s.value.displayName,coverUrl:l.value,filePath:e.value,songs:[],createdAt:x()});p.value=!1,t.value||o.push({name:"PlaylistDetails",params:{id:d.id}})}},fileError:c,handleChange:e=>{let l=e.target.files[0];console.log(l),l&&m.includes(l.type)?(u.value=l,c.value=null):(u.value=null,c.value="Please select an image file (png or jpg)")},isPending:p}}},_e=y("h4",null,"Create a New Playlist",-1),Oe=y("label",null,"Upload Playlist Cover Image",-1),xe={class:"error"},qe={key:0},Fe={key:1,disabled:""};Ee.render=function(e,l,a,t,n,s){return m(),v("div",null,[y("form",{onSubmit:l[4]||(l[4]=I(((...e)=>t.handleSubmit&&t.handleSubmit(...e)),["prevent"]))},[_e,U(y("input",{type:"text",required:"",placeholder:"Playlist title","onUpdate:modelValue":l[1]||(l[1]=e=>t.title=e)},null,512),[[D,t.title]]),U(y("textarea",{required:"",placeholder:"Playlist description...","onUpdate:modelValue":l[2]||(l[2]=e=>t.description=e)},null,512),[[D,t.description]]),Oe,y("input",{type:"file",onChange:l[3]||(l[3]=(...e)=>t.handleChange&&t.handleChange(...e))},null,32),y("div",xe,g(t.fileError),1),t.isPending?(m(),v("button",Fe,"Saving...")):(m(),v("button",qe,"Create"))],32)])};const He=(e,l)=>{let a=d(null),t=d(!1),n=E.collection(e).doc(l);return{error:a,isPending:t,deleteDoc:async()=>{t.value=!0,a.value=null;try{const e=await n.delete();return t.value=!1,e}catch(e){console.log(e.message),t.value=!1,a.value="could not delete the document"}},updateDoc:async e=>{t.value=!0,a.value=null;try{const l=await n.update(e);return t.value=!1,l}catch(l){console.log(l.message),t.value=!1,a.value="could not update the document"}}}};const Me={props:["playlist"],setup(e){const l=d(""),a=d(""),t=d(!1),{updateDoc:n}=He("playlists",e.playlist.id);return{title:l,artist:a,showForm:t,handleSubmit:async()=>{const t={title:l.value,artist:a.value,id:Math.floor(1e6*Math.random())};await n({songs:[...e.playlist.songs,t]}),l.value="",a.value=""}}}},ze=b("data-v-2cb15228");c("data-v-2cb15228");const Re={class:"add-song"},Be=y("h4",null,"Add a New Song",-1),Te=y("button",null,"Add",-1);p();const We=ze(((e,l,a,t,n,s)=>(m(),v("div",Re,[t.showForm?C("",!0):(m(),v("button",{key:0,onClick:l[1]||(l[1]=e=>t.showForm=!0)},"Add Songs")),t.showForm?(m(),v("form",{key:1,onSubmit:l[4]||(l[4]=I(((...e)=>t.handleSubmit&&t.handleSubmit(...e)),["prevent"]))},[Be,U(y("input",{type:"text",placeholder:"Song title",required:"","onUpdate:modelValue":l[2]||(l[2]=e=>t.title=e)},null,512),[[D,t.title]]),U(y("input",{type:"text",placeholder:"Artist",required:"","onUpdate:modelValue":l[3]||(l[3]=e=>t.artist=e)},null,512),[[D,t.artist]]),Te],32)):C("",!0)]))));Me.render=We,Me.__scopeId="data-v-2cb15228";const $e={props:["id"],components:{AddSong:Me},setup(e){const{error:l,document:a}=((e,l)=>{const a=d(null),t=d(null),n=E.collection(e).doc(l).onSnapshot((e=>{e.data()?(a.value=i(r({},e.data()),{id:e.id}),t.value=null):t.value="that document does not exist"}),(e=>{console.log(e.message),t.value="could not fetch the document"}));return S((e=>{e((()=>n()))})),{error:t,document:a}})("playlists",e.id),{user:t}=z(),{deleteDoc:n,updateDoc:s}=He("playlists",e.id),{deleteImage:o}=Ve(),u=h(),c=j((()=>a.value&&t.value&&t.value.uid==a.value.userId));return{error:l,playlist:a,ownership:c,handleDelete:async()=>{await n(),await o(a.value.filePath),u.push({name:"Home"})},handleClick:async e=>{const l=a.value.songs.filter((l=>l.id!=e));await s({songs:l})}}}},Ge={key:0,class:"error"},Je={key:1,class:"playlist-details"},Ke={class:"playlist-info"},Qe={class:"cover"},Xe={class:"username"},Ye={class:"description"},Ze={class:"song-list"},el={key:0},ll={class:"details"};$e.render=function(e,l,a,t,n,s){const o=w("AddSong");return m(),v("div",null,[t.error?(m(),v("div",Ge,g(t.error),1)):C("",!0),t.playlist?(m(),v("div",Je,[y("div",Ke,[y("div",Qe,[y("img",{src:t.playlist.coverUrl},null,8,["src"])]),y("h2",null,g(t.playlist.title),1),y("p",Xe,"Created by "+g(t.playlist.userName),1),y("p",Ye,g(t.playlist.description),1),t.ownership?(m(),v("button",{key:0,onClick:l[1]||(l[1]=(...e)=>t.handleDelete&&t.handleDelete(...e))},"Delete Playlist")):C("",!0)]),y("div",Ze,[t.playlist.songs.length?C("",!0):(m(),v("div",el,"No songs have been added to this playlist yet.")),(m(!0),v(k,null,P(t.playlist.songs,(e=>(m(),v("div",{class:"single-song",key:e.id},[y("div",ll,[y("h3",null,g(e.title),1),y("p",null,g(e.artist),1)]),t.ownership?(m(),v("button",{key:0,onClick:l=>t.handleClick(e.id)},"delete",8,["onClick"])):C("",!0)])))),128)),y(o,{playlist:t.playlist},null,8,["playlist"])])])):C("",!0)])};const al={components:{ListView:te},setup(){const{user:e}=z(),{documents:l}=de("playlists",["userId","==",e.value.uid]);return console.log(l),{playlists:l}}},tl={class:"user-playlists"},nl=y("h2",null,"My Playlists",-1),sl={key:0},ol=f("Create a New Playlist");al.render=function(e,l,a,t,n,s){const o=w("ListView"),r=w("router-link");return m(),v("div",tl,[nl,t.playlists?(m(),v("div",sl,[y(o,{playlists:t.playlists},null,8,["playlists"])])):C("",!0),y(r,{to:{name:"CreatePlaylist"},class:"btn"},{default:A((()=>[ol])),_:1})])};const rl=(e,l,a)=>{_.currentUser?a():a({name:"Login"})},il=[{path:"/",name:"Home",component:ce,beforeEnter:rl},{path:"/login",name:"Login",component:be},{path:"/signup",name:"Signup",component:De},{path:"/playlists/create",name:"CreatePlaylist",component:Ee,beforeEnter:rl},{path:"/playlists/:id",name:"PlaylistDetails",component:$e,beforeEnter:rl,props:!0},{path:"/playlists/user",name:"UserPlaylists",component:al,beforeEnter:rl}],ul=N({history:L(),routes:il});let dl;_.onAuthStateChanged((()=>{dl||(dl=V(le).use(ul).mount("#app"))}));
